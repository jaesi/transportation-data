# [프로세스 정리]

## 1. 일별/시간대별 정류장 OD 통행량 집계 (/daily_hourly)
  1. step1_run_batch.py: 일별로 순회하며 목적통행으로 집계함 
  2. step2_grid_batch.py: 좌표 중 x,y 오기입을 변환하며, 그리드로 바꾸어줌
  3. step3_simplify.py: 산출된 데이터의 행 수가 과다하여 통행량 1인 OD를 기타로 재집계하여 단순화하는 프로세스

## 2. 통근 OD 데이터 산출 v2 (/work_od_v2)
  - utils.py: 유틸
  - config.py: 설정
    [전처리]
  1. step1_run_monthly_purpose_batch.py: 월별 목적통행 집계함
  2. step2_run_time_window_monthly.py: 평일의 주거지, 직장지 정류장 타임 윈도우 테이블 두개를 월별로 산출함
       * 출발/도착 구분을 없앤 하나의 정류장 및 좌표로 melted form으로 변환
  3. step3_run_correct_x_y.py: x, y 좌표가 뒤틀려있는 행들을 변환시켜줌
    [로직]
  4. step4_card_id_prepare.py: 카드데이터 유니크값 산출
  5. step5_dbscan.py: 각 카드별로 순회하며 dbscan으로 주거지, 직장지 군집 산출
  6. step6_card_merge.py: 각 월별로 나누어져있는 것을 한 파일로 결합
  7. step7_analysis.py: (추후 분석 용도) 월별 목적통행 테이블에 6번 카드 데이터만 결합하여 통행 패턴만 추출한 테이블
  8. step8_agg.py: 월별 목적통행 테이블에 step6의 card_id별 직주정류장을 결합해 집계하는 프로세스
  9. step8_xy_correct_grid: 정류장 데이터 -> x,y 좌표 틀린거 수정, 그리드 컬럼을 붙여서 파일로 저장하는 모듈
  10. step9_join_grid.py: 8번 집계 데이터에 step9 정류장 데이터를 붙여 최종 parquet파일로 저장